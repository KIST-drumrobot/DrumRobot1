function dg = dampShoulder(dq,q)
global T xhat yhat zhat
% Cost function to be maximized
% w = -1/2*(wsR'*wsR + wsL'*wsL)
n = length(q);
%% shoulder
% Relative angular velocity to the body
% NOTE: wb = zhat*dq(1); 
% wsR_abs = [zhat Rz(q(1))*xhat Rz(q(1))*Rx(q(2))*yhat]*[dq(1);dq(2);dq(3)];
wR = [Rz(q(1))*xhat Rz(q(1))*Rx(q(2))*yhat]*[dq(2);dq(3)];
wL = [Rz(q(1))*yhat Rz(q(1))*Ry(q(9))*xhat]*[dq(9);dq(10)];
w = [wR;wL];
% Differentiation over joint angle(q)
dw = cell(n,1);
dwR1 = [dRz(q(1))*xhat dRz(q(1))*Rx(q(2))*yhat]*[dq(2);dq(3)];
dwL1 = [dRz(q(1))*xhat dRz(q(1))*Ry(q(9))*xhat]*[dq(9);dq(10)];
dw{1} = [dwR1;dwL1];
dw{2} = [0*xhat Rz(q(1))*dRx(q(2))*yhat]*[dq(2);dq(3)] + [Rz(q(1))*xhat Rz(q(1))*Rx(q(2))*yhat]*[1/T;0];
dw{3} = [Rz(q(1))*xhat Rz(q(1))*Rx(q(2))*yhat]*[0;1/T];
dw{9} = [0*yhat Rz(q(1))*dRy(q(9))*xhat]*[dq(9);dq(10)] + [Rz(q(1))*yhat Rz(q(1))*Ry(q(9))*xhat]*[1/T;0];
dw{10} = [Rz(q(1))*yhat Rz(q(1))*Ry(q(9))*xhat]*[0;1/T];
%% wrist
% wR = [Rz(q(1))*xhat ...
%     Rz(q(1))*Rx(q(2))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*xhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*Ry(q(7))*xhat]*...
%     [dq(2);dq(3);dq(4);dq(5);dq(6);dq(7);dq(8)];
% wL = [Rz(q(1))*yhat ...
%     Rz(q(1))*Ry(q(9))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*yhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*Rx(q(14))*yhat]*...
%     [dq(9);dq(10);dq(11);dq(12);dq(13);dq(14);dq(15)];
% w = [wR;wL];
% % Differentiation over joint angle(q)
% dw = cell(n,1);
% dwR1 = [dRz(q(1))*xhat ...
%     dRz(q(1))*Rx(q(2))*yhat ...
%     dRz(q(1))*Rx(q(2))*Ry(q(3))*zhat ...
%     dRz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*xhat ...
%     dRz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*zhat ...
%     dRz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*yhat ...
%     dRz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*Ry(q(7))*xhat]*...
%     [dq(2);dq(3);dq(4);dq(5);dq(6);dq(7);dq(8)];
% dwL1 = [dRz(q(1))*yhat ...
%     dRz(q(1))*Ry(q(9))*xhat ...
%     dRz(q(1))*Ry(q(9))*Rx(q(10))*zhat ...
%     dRz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*yhat ...
%     dRz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*zhat ...
%     dRz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*xhat ...
%     dRz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*Rx(q(14))*yhat]*...
%     [dq(9);dq(10);dq(11);dq(12);dq(13);dq(14);dq(15)];
% dw{1} = [dwR1;dwL1];
% dw{2} = [0*xhat ...
%     Rz(q(1))*dRx(q(2))*yhat ...
%     Rz(q(1))*dRx(q(2))*Ry(q(3))*zhat ...
%     Rz(q(1))*dRx(q(2))*Ry(q(3))*Rz(q(4))*xhat ...
%     Rz(q(1))*dRx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*zhat ...
%     Rz(q(1))*dRx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*yhat ...
%     Rz(q(1))*dRx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*Ry(q(7))*xhat]*...
%     [dq(2);dq(3);dq(4);dq(5);dq(6);dq(7);dq(8)] + ...
%     [Rz(q(1))*xhat ...
%     Rz(q(1))*Rx(q(2))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*xhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*Ry(q(7))*xhat]*...
%     [1/T;0;0;0;0;0;0];
% dw{3} = [0*xhat ...
%     0*yhat ...
%     Rz(q(1))*Rx(q(2))*dRy(q(3))*zhat ...
%     Rz(q(1))*Rx(q(2))*dRy(q(3))*Rz(q(4))*xhat ...
%     Rz(q(1))*Rx(q(2))*dRy(q(3))*Rz(q(4))*Rx(q(5))*zhat ...
%     Rz(q(1))*Rx(q(2))*dRy(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*yhat ...
%     Rz(q(1))*Rx(q(2))*dRy(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*Ry(q(7))*xhat]*...
%     [dq(2);dq(3);dq(4);dq(5);dq(6);dq(7);dq(8)] + ...
%     [Rz(q(1))*xhat ...
%     Rz(q(1))*Rx(q(2))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*xhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*Ry(q(7))*xhat]*...
%     [0;1/T;0;0;0;0;0];
% dw{4} = [0*xhat ...
%     0*yhat ...
%     0*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*dRz(q(4))*xhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*dRz(q(4))*Rx(q(5))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*dRz(q(4))*Rx(q(5))*Rz(q(6))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*dRz(q(4))*Rx(q(5))*Rz(q(6))*Ry(q(7))*xhat]*...
%     [dq(2);dq(3);dq(4);dq(5);dq(6);dq(7);dq(8)] + ...
%     [Rz(q(1))*xhat ...
%     Rz(q(1))*Rx(q(2))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*xhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*Ry(q(7))*xhat]*...
%     [0;0;1/T;0;0;0;0];
% dw{5} = [0*xhat ...
%     0*yhat ...
%     0*zhat ...
%     0*xhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*dRx(q(5))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*dRx(q(5))*Rz(q(6))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*dRx(q(5))*Rz(q(6))*Ry(q(7))*xhat]*...
%     [dq(2);dq(3);dq(4);dq(5);dq(6);dq(7);dq(8)] + ...
%     [Rz(q(1))*xhat ...
%     Rz(q(1))*Rx(q(2))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*xhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*Ry(q(7))*xhat]*...
%     [0;0;0;1/T;0;0;0];
% dw{6} = [0*xhat ...
%     0*yhat ...
%     0*zhat ...
%     0*xhat ...
%     0*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*dRz(q(6))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*dRz(q(6))*Ry(q(7))*xhat]*...
%     [dq(2);dq(3);dq(4);dq(5);dq(6);dq(7);dq(8)] + ...
%     [Rz(q(1))*xhat ...
%     Rz(q(1))*Rx(q(2))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*xhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*Ry(q(7))*xhat]*...
%     [0;0;0;0;1/T;0;0];
% dw{7} = [0*xhat ...
%     0*yhat ...
%     0*zhat ...
%     0*xhat ...
%     0*zhat ...
%     0*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*dRy(q(7))*xhat]*...
%     [dq(2);dq(3);dq(4);dq(5);dq(6);dq(7);dq(8)] + ...
%     [Rz(q(1))*xhat ...
%     Rz(q(1))*Rx(q(2))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*xhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*Ry(q(7))*xhat]*...
%     [0;0;0;0;0;1/T;0];
% dw{8} = [0*xhat ...
%     0*yhat ...
%     0*zhat ...
%     0*xhat ...
%     0*zhat ...
%     0*yhat ...
%     0*xhat]*...
%     [dq(2);dq(3);dq(4);dq(5);dq(6);dq(7);dq(8)] + ...
%     [Rz(q(1))*xhat ...
%     Rz(q(1))*Rx(q(2))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*xhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*zhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*yhat ...
%     Rz(q(1))*Rx(q(2))*Ry(q(3))*Rz(q(4))*Rx(q(5))*Rz(q(6))*Ry(q(7))*xhat]*...
%     [0;0;0;0;0;0;1/T];
% dw{9} = [0*yhat ...
%     Rz(q(1))*dRy(q(9))*xhat ...
%     Rz(q(1))*dRy(q(9))*Rx(q(10))*zhat ...
%     Rz(q(1))*dRy(q(9))*Rx(q(10))*Rz(q(11))*yhat ...
%     Rz(q(1))*dRy(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*zhat ...
%     Rz(q(1))*dRy(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*xhat ...
%     Rz(q(1))*dRy(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*Rx(q(14))*yhat]*...
%     [dq(9);dq(10);dq(11);dq(12);dq(13);dq(14);dq(15)] + ...
%     [Rz(q(1))*yhat ...
%     Rz(q(1))*Ry(q(9))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*yhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*Rx(q(14))*yhat]*...
%     [1/T;0;0;0;0;0;0];
% dw{10} = [0*yhat ...
%     0*xhat ...
%     Rz(q(1))*Ry(q(9))*dRx(q(10))*zhat ...
%     Rz(q(1))*Ry(q(9))*dRx(q(10))*Rz(q(11))*yhat ...
%     Rz(q(1))*Ry(q(9))*dRx(q(10))*Rz(q(11))*Ry(q(12))*zhat ...
%     Rz(q(1))*Ry(q(9))*dRx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*xhat ...
%     Rz(q(1))*Ry(q(9))*dRx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*Rx(q(14))*yhat]*...
%     [dq(9);dq(10);dq(11);dq(12);dq(13);dq(14);dq(15)] + ...
%     [Rz(q(1))*yhat ...
%     Rz(q(1))*Ry(q(9))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*yhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*Rx(q(14))*yhat]*...
%     [0;1/T;0;0;0;0;0];
% dw{11} = [0*yhat ...
%     0*xhat ...
%     0*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*dRz(q(11))*yhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*dRz(q(11))*Ry(q(12))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*dRz(q(11))*Ry(q(12))*Rz(q(13))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*dRz(q(11))*Ry(q(12))*Rz(q(13))*Rx(q(14))*yhat]*...
%     [dq(9);dq(10);dq(11);dq(12);dq(13);dq(14);dq(15)] + ...
%     [Rz(q(1))*yhat ...
%     Rz(q(1))*Ry(q(9))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*yhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*Rx(q(14))*yhat]*...
%     [0;0;1/T;0;0;0;0];
% dw{12} = [0*yhat ...
%     0*xhat ...
%     0*zhat ...
%     0*yhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*dRy(q(12))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*dRy(q(12))*Rz(q(13))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*dRy(q(12))*Rz(q(13))*Rx(q(14))*yhat]*...
%     [dq(9);dq(10);dq(11);dq(12);dq(13);dq(14);dq(15)] + ...
%     [Rz(q(1))*yhat ...
%     Rz(q(1))*Ry(q(9))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*yhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*Rx(q(14))*yhat]*...
%     [0;0;0;1/T;0;0;0];
% dw{13} = [0*yhat ...
%     0*xhat ...
%     0*zhat ...
%     0*yhat ...
%     0*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*dRz(q(13))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*dRz(q(13))*Rx(q(14))*yhat]*...
%     [dq(9);dq(10);dq(11);dq(12);dq(13);dq(14);dq(15)] + ...
%     [Rz(q(1))*yhat ...
%     Rz(q(1))*Ry(q(9))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*yhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*Rx(q(14))*yhat]*...
%     [0;0;0;0;1/T;0;0];
% dw{14} = [0*yhat ...
%     0*xhat ...
%     0*zhat ...
%     0*yhat ...
%     0*zhat ...
%     0*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*dRx(q(14))*yhat]*...
%     [dq(9);dq(10);dq(11);dq(12);dq(13);dq(14);dq(15)] + ...
%     [Rz(q(1))*yhat ...
%     Rz(q(1))*Ry(q(9))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*yhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*Rx(q(14))*yhat]*...
%     [0;0;0;0;0;1/T;0];
% dw{15} = [0*yhat ...
%     0*xhat ...
%     0*zhat ...
%     0*yhat ...
%     0*zhat ...
%     0*xhat ...
%     0*yhat]*...
%     [dq(9);dq(10);dq(11);dq(12);dq(13);dq(14);dq(15)] + ...
%     [Rz(q(1))*yhat ...
%     Rz(q(1))*Ry(q(9))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*yhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*zhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*xhat ...
%     Rz(q(1))*Ry(q(9))*Rx(q(10))*Rz(q(11))*Ry(q(12))*Rz(q(13))*Rx(q(14))*yhat]*...
%     [0;0;0;0;0;0;1/T];
%% gradient
dg = zeros(n,1);
dg(1) = -dw{1}'*w;
dg(2) = -dw{2}'*wR;
dg(3) = -dw{3}'*wR;
% dg(4) = -dw{4}'*wR;
% dg(5) = -dw{5}'*wR;
% dg(6) = -dw{6}'*wR;
% dg(7) = -dw{7}'*wR;
% dg(8) = -dw{8}'*wR;
dg(9) = -dw{9}'*wL;
dg(10) = -dw{10}'*wL;
% dg(11) = -dw{11}'*wL;
% dg(12) = -dw{12}'*wL;
% dg(13) = -dw{13}'*wL;
% dg(14) = -dw{14}'*wL;
% dg(15) = -dw{15}'*wL;

k0 = .002;
dg = k0*dg;